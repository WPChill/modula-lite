"undefined"!=typeof jQuery&&(jQuery.modulaFancybox={open:function(o,e,n){modulaFancybox.open(o,e,n)}});var modulaFancybox={open:function(o,e,n){return o.forEach((function(e,n){void 0!==e.opts.caption&&(o[n].caption=e.opts.caption),void 0!==e.opts.thumb&&(o[n].thumb=e.opts.thumb)})),e.startIndex=n,void 0!==e.Slideshow&&(e.Slideshow.progressParentEl=function(o){return o.instance.container}),void 0!==e.Toolbar&&void 0!==e.Toolbar.items&&void 0!==e.Toolbar.items.share&&(e.Toolbar.items.share.click=function(){ModulaOpenShare()}),e.on={},e.on["*"]=function(o,e){jQuery(document).trigger("modula_fancybox_"+e.replace(/\./g,"_"),[o,this])},e.on["Carousel.ready Carousel.change"]=function(o,e){var n=o.options,t=void 0!==n.Slideshow&&void 0!==n.Slideshow.pauseOnHover&&n.Slideshow.pauseOnHover,a=o.plugins.Slideshow.ref,i=!1;"1"==t&&(document.querySelector(".modula-fancybox-container .fancybox__slide .fancybox__content").addEventListener("mouseover",(function(o){"play"==a.state&&(i=!0,a.stop())})),document.querySelector(".modula-fancybox-container .fancybox__slide .fancybox__content").addEventListener("mouseout",(function(o){"ready"==a.state&&i&&(i=!1,a.start())})))},e.on.init=function(o){jQuery(document).trigger("modula_fancybox_lightbox_on_init",[o,this])},new ModulaFancybox(o,e)},getInstance:function(){return this}};function escapeHtml(o){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(o).replace(/[&<>"'`=\/]/g,(function(o){return e[o]}))}function ModulaOpenShare(){var o=ModulaFancybox.getInstance(),e=ModulaFancybox.getSlide(),n=void 0!==e.opts.image_src?e.opts.image_src:e.src,t="<div class='modula-fancybox-share'><h1>"+o.options.l10n.SHARE+"</h1><p>",a=JSON.parse(ModulaShareButtons);o.options.modulaShare.forEach((function(i,r){var c=(o.options.lightboxEmailMessage.length?o.options.lightboxEmailMessage:o.options.l10n.EMAIL).replace(/\%%gallery_link%%/g,window.location.href).replace(/\%%image_link%%/g,n),l=void 0!==e.opts.alt?e.opts.alt:"";""===l&&e.caption&&void 0!==e.caption&&(l=e.caption),t+=a[i].template({media:"image"===e.type?encodeURIComponent(n):"",modulaShareUrl:encodeURIComponent(n),descr:encodeURIComponent(l),subject:encodeURIComponent(o.options.lightboxEmailSubject),emailMessage:encodeURIComponent(c)})})),t=(t+="</p><p><input class='modula-fancybox-share__input' type='text' value='"+escapeHtml(n)+"' /></p></div>").template({url_raw:escapeHtml(n)}),new ModulaFancybox([{src:t,type:"html",width:640,height:360}],{mainClass:"modula-fancybox-container"})}String.prototype.template=function(o){return this.replace(/\{([^\}]+)\}/g,(function(e,n){for(var t=o,a=n.split("|")[0].split("."),i=0;i<a.length;i++)if(null==(t="function"==typeof t[a[i]]?t[a[i]]():t[a[i]]))return-1!==n.indexOf("|")?n.split("|")[1]:e;return t}))};