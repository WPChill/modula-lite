(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.element;function i(){const e=void 0!==modulaData.url?`${modulaData.url}assets/images/license-logo.png`:"",t=void 0!==modulaData.url?`${modulaData.url}assets/images/license-logo-footer.png`:"";return React.createElement("div",{className:"modula_license_logo_container",style:{backgroundImage:`url(${t})`}},React.createElement("img",{src:e,alt:"modula logo",className:"modula_license_logo"}))}const r=window.wp.components,n={modulaToggle:"Yh4FtTCJdgX8uvckLcKV",modulaToggleItems:"Z8BRh8oTpXxivBOd0_Gl",modulaToggleLabel:"QoYL1i9Lfrhta8qvBIvS",modulaToggleInput:"eBtUAmtNjnOVVAskUmom",modulaToggleTrack:"iXr5TZNXydE7J3PUINRU",modulaToggleThumb:"cHe4ACg6_W_YhnMXdom2",modulaToggleOff:"Vqei88gjNbVLuPhB5wNG",modulaToggleOn:"PGyFA1WZvX7Sf2dDvpB8"},a="SET_LICENSE_KEY",o="SET_ALT_SERVER",u="SET_STATUS",c="SET_MESSAGE",l=(e,t)=>{switch(t.type){case a:return{...e,licenseKey:t.payload};case o:return{...e,altServer:t.payload};case u:return{...e,status:t.payload};case c:return{...e,message:t.payload};default:return e}},h={licenseKey:"",altServer:!1,status:"",message:!1},d=(0,s.createContext)(h),p=({children:e})=>{const[t,i]=(0,s.useReducer)(l,h),r={state:t,dispatch:i};return React.createElement(d.Provider,{value:r},e)},f=()=>{const e=(0,s.useContext)(d);if(void 0===e)throw new Error("useStateContext must be used within a SettingsProvider");return e},y=e=>({type:a,payload:e}),m=e=>({type:o,payload:e});function g(){const{state:e,dispatch:t}=f();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${n.modulaToggle} ${"valid"===e?.status?.license?n.modulaToggleDisabled:""} modula_license_input`},React.createElement("input",{className:n.modulaToggleInput,type:"checkbox",value:"1",checked:e.altServer||!1,onChange:e=>t(m(e.target.checked)),disabled:"valid"===e?.status?.license}),React.createElement("div",{className:n.modulaToggleItems},React.createElement("span",{className:n.modulaToggleTrack}),React.createElement("span",{className:n.modulaToggleThumb}),React.createElement("svg",{className:n.modulaToggleOff,width:"6",height:"6","aria-hidden":"true",role:"img",focusable:"false",viewBox:"0 0 6 6"},React.createElement("path",{d:"M3 1.5c.8 0 1.5.7 1.5 1.5S3.8 4.5 3 4.5 1.5 3.8 1.5 3 2.2 1.5 3 1.5M3 0C1.3 0 0 1.3 0 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3z"})),React.createElement("svg",{className:n.modulaToggleOn,width:"2",height:"6","aria-hidden":"true",role:"img",focusable:"false",viewBox:"0 0 2 6"},React.createElement("path",{d:"M0 0h2v6H0z"})))))}var v=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},b="undefined"==typeof window||"Deno"in globalThis;function R(){}function w(e){return"number"==typeof e&&e>=0&&e!==1/0}function C(e,t){return Math.max(e+(t||0)-Date.now(),0)}function O(e,t){return"function"==typeof e?e(t):e}function S(e,t){return"function"==typeof e?e(t):e}function E(e,t){const{type:s="all",exact:i,fetchStatus:r,predicate:n,queryKey:a,stale:o}=e;if(a)if(i){if(t.queryHash!==q(a,t.options))return!1}else if(!Q(t.queryKey,a))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return!("boolean"==typeof o&&t.isStale()!==o||r&&r!==t.state.fetchStatus||n&&!n(t))}function _(e,t){const{exact:s,status:i,predicate:r,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(T(t.options.mutationKey)!==T(n))return!1}else if(!Q(t.options.mutationKey,n))return!1}return!(i&&t.state.status!==i||r&&!r(t))}function q(e,t){return(t?.queryKeyHashFn||T)(e)}function T(e){return JSON.stringify(e,((e,t)=>I(t)?Object.keys(t).sort().reduce(((e,s)=>(e[s]=t[s],e)),{}):t))}function Q(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every((s=>Q(e[s],t[s])))}function P(e,t){if(e===t)return e;const s=D(e)&&D(t);if(s||I(e)&&I(t)){const i=s?e:Object.keys(e),r=i.length,n=s?t:Object.keys(t),a=n.length,o=s?[]:{};let u=0;for(let r=0;r<a;r++){const a=s?r:n[r];(!s&&i.includes(a)||s)&&void 0===e[a]&&void 0===t[a]?(o[a]=void 0,u++):(o[a]=P(e[a],t[a]),o[a]===e[a]&&void 0!==e[a]&&u++)}return r===a&&u===r?e:o}return t}function F(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function D(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function I(e){if(!x(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!x(s)&&!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function x(e){return"[object Object]"===Object.prototype.toString.call(e)}function A(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?P(e,t):t}function M(e,t,s=0){const i=[...e,t];return s&&i.length>s?i.slice(1):i}function N(e,t,s=0){const i=[t,...e];return s&&i.length>s?i.slice(0,-1):i}var k=Symbol();function U(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==k?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var j=new class extends v{#e;#t;#s;constructor(){super(),this.#s=e=>{if(!b&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#s=e,this.#t?.(),this.#t=e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"==typeof this.#e?this.#e:"hidden"!==globalThis.document?.visibilityState}},K=e=>setTimeout(e,0),L=function(){let e=[],t=0,s=e=>{e()},i=e=>{e()},r=K;const n=i=>{t?e.push(i):r((()=>{s(i)}))};return{batch:n=>{let a;t++;try{a=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r((()=>{i((()=>{t.forEach((e=>{s(e)}))}))}))})()}return a},batchCalls:e=>(...t)=>{n((()=>{e(...t)}))},schedule:n,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{r=e}}}(),H=new class extends v{#i=!0;#t;#s;constructor(){super(),this.#s=e=>{if(!b&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#s=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#i!==e&&(this.#i=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#i}};function G(){let e,t;const s=new Promise(((s,i)=>{e=s,t=i}));function i(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch((()=>{})),s.resolve=t=>{i({status:"fulfilled",value:t}),e(t)},s.reject=e=>{i({status:"rejected",reason:e}),t(e)},s}function B(e){return Math.min(1e3*2**e,3e4)}function W(e){return"online"!==(e??"online")||H.isOnline()}var X=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function $(e){return e instanceof X}function V(e){let t,s=!1,i=0,r=!1;const n=G(),a=()=>j.isFocused()&&("always"===e.networkMode||H.isOnline())&&e.canRun(),o=()=>W(e.networkMode)&&e.canRun(),u=s=>{r||(r=!0,e.onSuccess?.(s),t?.(),n.resolve(s))},c=s=>{r||(r=!0,e.onError?.(s),t?.(),n.reject(s))},l=()=>new Promise((s=>{t=e=>{(r||a())&&s(e)},e.onPause?.()})).then((()=>{t=void 0,r||e.onContinue?.()})),h=()=>{if(r)return;let t;const n=0===i?e.initialPromise:void 0;try{t=n??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(u).catch((t=>{if(r)return;const n=e.retry??(b?0:3),o=e.retryDelay??B,u="function"==typeof o?o(i,t):o,d=!0===n||"number"==typeof n&&i<n||"function"==typeof n&&n(i,t);var p;!s&&d?(i++,e.onFail?.(i,t),(p=u,new Promise((e=>{setTimeout(e,p)}))).then((()=>a()?void 0:l())).then((()=>{s?c(t):h()}))):c(t)}))};return{promise:n,cancel:t=>{r||(c(new X(t)),e.abort?.())},continue:()=>(t?.(),n),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:o,start:()=>(o()?h():l().then(h),n)}}var Y=class{#r;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),w(this.gcTime)&&(this.#r=setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(b?1/0:3e5))}clearGcTimeout(){this.#r&&(clearTimeout(this.#r),this.#r=void 0)}},z=class extends Y{#n;#a;#o;#u;#c;#l;#h;constructor(e){super(),this.#h=!1,this.#l=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#u=e.client,this.#o=this.#u.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#n=function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,i=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=e.state??this.#n,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#c?.promise}setOptions(e){this.options={...this.#l,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#o.remove(this)}setData(e,t){const s=A(this.state.data,e,this.options);return this.#d({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#d({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#c?.promise;return this.#c?.cancel(e),t?t.then(R).catch(R):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#n)}isActive(){return this.observers.some((e=>!1!==S(e.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===k||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return!!this.state.isInvalidated||(this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data)}isStaleByTime(e=0){return this.state.isInvalidated||void 0===this.state.data||!C(this.state.dataUpdatedAt,e)}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#c?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#c?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#c&&(this.#h?this.#c.cancel({revert:!0}):this.#c.cancelRetry()),this.scheduleGc()),this.#o.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#d({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#c)return this.#c.continueRetry(),this.#c.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const s=new AbortController,i=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#h=!0,s.signal)})},r={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#u,state:this.state,fetchFn:()=>{const e=U(this.options,t),s={client:this.#u,queryKey:this.queryKey,meta:this.meta};return i(s),this.#h=!1,this.options.persister?this.options.persister(e,s,this):e(s)}};i(r),this.options.behavior?.onFetch(r,this),this.#a=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===r.fetchOptions?.meta||this.#d({type:"fetch",meta:r.fetchOptions?.meta});const n=e=>{$(e)&&e.silent||this.#d({type:"error",error:e}),$(e)||(this.#o.config.onError?.(e,this),this.#o.config.onSettled?.(this.state.data,e,this)),this.scheduleGc()};return this.#c=V({initialPromise:t?.initialPromise,fn:r.fetchFn,abort:s.abort.bind(s),onSuccess:e=>{if(void 0!==e){try{this.setData(e)}catch(e){return void n(e)}this.#o.config.onSuccess?.(e,this),this.#o.config.onSettled?.(e,this.state.error,this),this.scheduleGc()}else n(new Error(`${this.queryHash} data is undefined`))},onError:n,onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:()=>{this.#d({type:"continue"})},retry:r.options.retry,retryDelay:r.options.retryDelay,networkMode:r.options.networkMode,canRun:()=>!0}),this.#c.start()}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...J(t.data,this.options),fetchMeta:e.meta??null};case"success":return{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return $(s)&&s.revert&&this.#a?{...this.#a,fetchStatus:"idle"}:{...t,error:s,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),L.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#o.notify({query:this,type:"updated",action:e})}))}};function J(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:W(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}var Z=class extends v{constructor(e,t){super(),this.options=t,this.#u=e,this.#p=null,this.#f=G(),this.options.experimental_prefetchInRender||this.#f.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#u;#y=void 0;#m=void 0;#g=void 0;#v;#b;#f;#p;#R;#w;#C;#O;#S;#E;#_=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#y.addObserver(this),ee(this.#y,this.options)?this.#q():this.updateResult(),this.#T())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return te(this.#y,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return te(this.#y,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#Q(),this.#P(),this.#y.removeObserver(this)}setOptions(e){const t=this.options,s=this.#y;if(this.options=this.#u.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof S(this.options.enabled,this.#y))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#F(),this.#y.setOptions(this.options),t._defaulted&&!F(this.options,t)&&this.#u.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#y,observer:this});const i=this.hasListeners();i&&se(this.#y,s,this.options,t)&&this.#q(),this.updateResult(),!i||this.#y===s&&S(this.options.enabled,this.#y)===S(t.enabled,this.#y)&&O(this.options.staleTime,this.#y)===O(t.staleTime,this.#y)||this.#D();const r=this.#I();!i||this.#y===s&&S(this.options.enabled,this.#y)===S(t.enabled,this.#y)&&r===this.#E||this.#x(r)}getOptimisticResult(e){const t=this.#u.getQueryCache().build(this.#u,e),s=this.createResult(t,e);return i=s,!F(this.getCurrentResult(),i)&&(this.#g=s,this.#b=this.options,this.#v=this.#y.state),s;var i}getCurrentResult(){return this.#g}trackResult(e,t){const s={};return Object.keys(e).forEach((i=>{Object.defineProperty(s,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),t?.(i),e[i])})})),s}trackProp(e){this.#_.add(e)}getCurrentQuery(){return this.#y}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#u.defaultQueryOptions(e),s=this.#u.getQueryCache().build(this.#u,t);return s.fetch().then((()=>this.createResult(s,t)))}fetch(e){return this.#q({...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),this.#g)))}#q(e){this.#F();let t=this.#y.fetch(this.options,e);return e?.throwOnError||(t=t.catch(R)),t}#D(){this.#Q();const e=O(this.options.staleTime,this.#y);if(b||this.#g.isStale||!w(e))return;const t=C(this.#g.dataUpdatedAt,e)+1;this.#O=setTimeout((()=>{this.#g.isStale||this.updateResult()}),t)}#I(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#y):this.options.refetchInterval)??!1}#x(e){this.#P(),this.#E=e,!b&&!1!==S(this.options.enabled,this.#y)&&w(this.#E)&&0!==this.#E&&(this.#S=setInterval((()=>{(this.options.refetchIntervalInBackground||j.isFocused())&&this.#q()}),this.#E))}#T(){this.#D(),this.#x(this.#I())}#Q(){this.#O&&(clearTimeout(this.#O),this.#O=void 0)}#P(){this.#S&&(clearInterval(this.#S),this.#S=void 0)}createResult(e,t){const s=this.#y,i=this.options,r=this.#g,n=this.#v,a=this.#b,o=e!==s?e.state:this.#m,{state:u}=e;let c,l={...u},h=!1;if(t._optimisticResults){const r=this.hasListeners(),n=!r&&ee(e,t),a=r&&se(e,s,t,i);(n||a)&&(l={...l,...J(u.data,e.options)}),"isRestoring"===t._optimisticResults&&(l.fetchStatus="idle")}let{error:d,errorUpdatedAt:p,status:f}=l;c=l.data;let y=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===f){let e;r?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(e=r.data,y=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#C?.state.data,this.#C):t.placeholderData,void 0!==e&&(f="success",c=A(r?.data,e,t),h=!0)}if(t.select&&void 0!==c&&!y)if(r&&c===n?.data&&t.select===this.#R)c=this.#w;else try{this.#R=t.select,c=t.select(c),c=A(r?.data,c,t),this.#w=c,this.#p=null}catch(e){this.#p=e}this.#p&&(d=this.#p,c=this.#w,p=Date.now(),f="error");const m="fetching"===l.fetchStatus,g="pending"===f,v="error"===f,b=g&&m,R=void 0!==c,w={status:f,fetchStatus:l.fetchStatus,isPending:g,isSuccess:"success"===f,isError:v,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:l.dataUpdatedAt,error:d,errorUpdatedAt:p,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>o.dataUpdateCount||l.errorUpdateCount>o.errorUpdateCount,isFetching:m,isRefetching:m&&!g,isLoadingError:v&&!R,isPaused:"paused"===l.fetchStatus,isPlaceholderData:h,isRefetchError:v&&R,isStale:ie(e,t),refetch:this.refetch,promise:this.#f};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===w.status?e.reject(w.error):void 0!==w.data&&e.resolve(w.data)},i=()=>{const e=this.#f=w.promise=G();t(e)},r=this.#f;switch(r.status){case"pending":e.queryHash===s.queryHash&&t(r);break;case"fulfilled":"error"!==w.status&&w.data===r.value||i();break;case"rejected":"error"===w.status&&w.error===r.reason||i()}}return w}updateResult(){const e=this.#g,t=this.createResult(this.#y,this.options);this.#v=this.#y.state,this.#b=this.options,void 0!==this.#v.data&&(this.#C=this.#y),F(t,e)||(this.#g=t,this.#A({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#_.size)return!0;const i=new Set(s??this.#_);return this.options.throwOnError&&i.add("error"),Object.keys(this.#g).some((t=>{const s=t;return this.#g[s]!==e[s]&&i.has(s)}))})()}))}#F(){const e=this.#u.getQueryCache().build(this.#u,this.options);if(e===this.#y)return;const t=this.#y;this.#y=e,this.#m=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#T()}#A(e){L.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e(this.#g)})),this.#u.getQueryCache().notify({query:this.#y,type:"observerResultsUpdated"})}))}};function ee(e,t){return function(e,t){return!1!==S(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&te(e,t,t.refetchOnMount)}function te(e,t,s){if(!1!==S(t.enabled,e)){const i="function"==typeof s?s(e):s;return"always"===i||!1!==i&&ie(e,t)}return!1}function se(e,t,s,i){return(e!==t||!1===S(i.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&ie(e,s)}function ie(e,t){return!1!==S(t.enabled,e)&&e.isStaleByTime(O(t.staleTime,e))}const re=window.ReactJSXRuntime;var ne=t.createContext(void 0),ae=e=>{const s=t.useContext(ne);if(e)return e;if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},oe=({client:e,children:s})=>(t.useEffect((()=>(e.mount(),()=>{e.unmount()})),[e]),(0,re.jsx)(ne.Provider,{value:e,children:s}));var ue=t.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}());function ce(){}var le=t.createContext(!1),he=(le.Provider,(e,t,s)=>t.fetchOptimistic(e).catch((()=>{s.clearReset()})));const de=window.wp.apiFetch;var pe=e.n(de);const fe=()=>{const e=function(e,s,i){const r=ae(i),n=t.useContext(le),a=t.useContext(ue),o=r.defaultQueryOptions(e);r.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=n?"isRestoring":"optimistic",(e=>{const t=e.staleTime;e.suspense&&(e.staleTime="function"==typeof t?(...e)=>Math.max(t(...e),1e3):Math.max(t??1e3,1e3),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3)))})(o),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(o,a),(e=>{t.useEffect((()=>{e.clearReset()}),[e])})(a);const u=!r.getQueryCache().get(o.queryHash),[c]=t.useState((()=>new s(r,o))),l=c.getOptimisticResult(o),h=!n&&!1!==e.subscribed;if(t.useSyncExternalStore(t.useCallback((e=>{const t=h?c.subscribe(L.batchCalls(e)):ce;return c.updateResult(),t}),[c,h]),(()=>c.getCurrentResult()),(()=>c.getCurrentResult())),t.useEffect((()=>{c.setOptions(o)}),[o,c]),((e,t)=>e?.suspense&&t.isPending)(o,l))throw he(o,c,a);if((({result:e,errorResetBoundary:t,throwOnError:s,query:i,suspense:r})=>{return e.isError&&!t.isReset()&&!e.isFetching&&i&&(r&&void 0===e.data||(n=s,a=[e.error,i],"function"==typeof n?n(...a):!!n));var n,a})({result:l,errorResetBoundary:a,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw l.error;if(r.getDefaultOptions().queries?._experimental_afterQuery?.(o,l),o.experimental_prefetchInRender&&!b&&((e,t)=>e.isLoading&&e.isFetching&&!t)(l,n)){const e=u?he(o,c,a):r.getQueryCache().get(o.queryHash)?.promise;e?.catch(ce).finally((()=>{c.updateResult()}))}return o.notifyOnChangeProps?l:c.trackResult(l)}({queryKey:["modula-license-query"],retry:1,queryFn:async()=>await pe()({path:"/modula-best-grid-gallery/v1/license-data",method:"GET"})},Z,void 0);return e},ye=window.wp.i18n;function me(){const{state:e,dispatch:t}=f(),{data:i,isLoading:n}=fe(),[a,o]=(0,s.useState)(!1),[l,h]=(0,s.useState)(!1),[d,p]=(0,s.useState)(!1),[v,b]=(0,s.useState)(""),[R,w]=(0,s.useState)(!1),[C,O]=(0,s.useState)(!1),S=(()=>{const e=ae();return async(t={},s=!1)=>{const i=new FormData;Object.entries(t).forEach((([e,t])=>{i.append(e,t)}));try{const t=await fetch(window.ajaxurl,{method:"POST",credentials:"same-origin",body:i}),r=await t.json();return s&&await e.invalidateQueries({queryKey:["modula-license-query"]}),r}catch(e){throw console.error("AJAX call failed:",e),e}}})();if((0,s.useEffect)((()=>{if("undefined"!==i&&!n){const{license:e,status:s,altServer:r,message:n}=i;t(y(e||"")),t(m(r||!1)),t({type:u,payload:s||""}),t({type:c,payload:n||!1})}}),[e.activeTab,t,i,n]),"undefined"!==i&&!n)return React.createElement("div",{className:"modula_license_inputs_container"},React.createElement("div",{className:"modula_license_button_wrapp"},React.createElement("span",{className:"modula_main_license_label"},(0,ye.__)("Your License","modula-best-grid-gallery")),React.createElement("div",{className:"modula_license_actions"},l&&React.createElement("span",{className:"modula_action_loading",dangerouslySetInnerHTML:{__html:l}}),React.createElement(r.Button,{className:"modula_license_button",onClick:async()=>{let t={};o(!0),"valid"!==e?.status?.license?(h((0,ye.__)("Activating license…","modula-best-grid-gallery")),t={action:"modula_save_license",license_security:modulaData.nonce,license:e.licenseKey,altServer:e.altServer}):(h((0,ye.__)("Deactivating license…","modula-best-grid-gallery")),t={action:"modula_deactivate_license",license_security:modulaData.nonce,altServer:e.altServer});const s=await S(t,!0);h(s),setTimeout((()=>{h(!1)}),2e3),o(!1)},disabled:a},a&&React.createElement(r.Spinner,null),"valid"===e?.status?.license?(0,ye.__)("Deactivate","modula-best-grid-gallery"):(0,ye.__)("Activate","modula-best-grid-gallery")))),React.createElement("div",{className:"modula_license_input_wrapp"},React.createElement("span",{className:"modula_input_label"},(0,ye.__)("License Key","modula-best-grid-gallery")),React.createElement(r.TextControl,{type:"password",className:"modula_license_input",value:e?.licenseKey,placeholder:(0,ye.__)("Your License Key","modula-best-grid-gallery"),onChange:e=>t(y(e)),disabled:"valid"===e?.status?.license}),"valid"!==e?.status?.license&&React.createElement(r.Button,{className:"modula_forgot_license_button",onClick:()=>p(!d)},d?(0,ye.__)("Cancel","modula-best-grid-gallery"):(0,ye.__)("Forgot license?","modula-best-grid-gallery")),React.createElement("div",{className:"modula_input_description_wrap"},React.createElement("span",{className:"ibox"},"i"),React.createElement("p",{className:"modula_input_description",dangerouslySetInnerHTML:{__html:e.message}}))),d&&React.createElement("div",{className:"modula_license_input_wrapp"},React.createElement("span",{className:"modula_input_label"},(0,ye.__)("Email","modula-best-grid-gallery")),React.createElement(r.TextControl,{type:"email",className:"modula_license_input",value:v,onChange:e=>b(e)}),React.createElement("div",{className:"modula_license_actions"},C&&React.createElement("span",{className:"modula_action_loading",dangerouslySetInnerHTML:{__html:C}}),React.createElement(r.Button,{className:"modula_license_button",onClick:async()=>{let t={};w(!0),O((0,ye.__)("Retrieving data…","modula-best-grid-gallery")),t={action:"modula_resend_license",license_security:modulaData.nonce,license_email:v,altServer:e.altServer};const s=await S(t,!0);O(s.data),setTimeout((()=>{O(!1)}),2e3),w(!1)},disabled:R},R&&React.createElement(r.Spinner,null),(0,ye.__)("Send Email","modula-best-grid-gallery")))),React.createElement("div",{className:"modula_license_input_wrapp"},React.createElement("span",{className:"modula_input_label"},(0,ye.__)("Use Alternative Server","modula-best-grid-gallery")),React.createElement(g,null),React.createElement("div",{className:"modula_input_description_wrap"},React.createElement("span",{className:"ibox"},"i"),React.createElement("p",{className:"modula_input_description"},(0,ye.__)("Sometimes there can be problems with the activation server, in which case please try the alternative one.","modula-best-grid-gallery")))))}function ge(){return React.createElement("div",{className:"modula_license_wrapper"},React.createElement(i,null),React.createElement(me,null))}var ve=class extends v{constructor(e={}){super(),this.config=e,this.#M=new Map}#M;build(e,t,s){const i=t.queryKey,r=t.queryHash??q(i,t);let n=this.get(r);return n||(n=new z({client:e,queryKey:i,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(i)}),this.add(n)),n}add(e){this.#M.has(e.queryHash)||(this.#M.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#M.get(e.queryHash);t&&(e.destroy(),t===e&&this.#M.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){L.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#M.get(e)}getAll(){return[...this.#M.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>E(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>E(e,t))):t}notify(e){L.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){L.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){L.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},be=class extends Y{#N;#k;#c;constructor(e){super(),this.mutationId=e.mutationId,this.#k=e.mutationCache,this.#N=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#N.includes(e)||(this.#N.push(e),this.clearGcTimeout(),this.#k.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#N=this.#N.filter((t=>t!==e)),this.scheduleGc(),this.#k.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#N.length||("pending"===this.state.status?this.scheduleGc():this.#k.remove(this))}continue(){return this.#c?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#d({type:"continue"})};this.#c=V({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#k.canRun(this)});const s="pending"===this.state.status,i=!this.#c.canStart();try{if(s)t();else{this.#d({type:"pending",variables:e,isPaused:i}),await(this.#k.config.onMutate?.(e,this));const t=await(this.options.onMutate?.(e));t!==this.state.context&&this.#d({type:"pending",context:t,variables:e,isPaused:i})}const r=await this.#c.start();return await(this.#k.config.onSuccess?.(r,e,this.state.context,this)),await(this.options.onSuccess?.(r,e,this.state.context)),await(this.#k.config.onSettled?.(r,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(r,null,e,this.state.context)),this.#d({type:"success",data:r}),r}catch(t){try{throw await(this.#k.config.onError?.(t,e,this.state.context,this)),await(this.options.onError?.(t,e,this.state.context)),await(this.#k.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,t,e,this.state.context)),t}finally{this.#d({type:"error",error:t})}}finally{this.#k.runNext(this)}}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),L.batch((()=>{this.#N.forEach((t=>{t.onMutationUpdate(e)})),this.#k.notify({mutation:this,type:"updated",action:e})}))}},Re=class extends v{constructor(e={}){super(),this.config=e,this.#U=new Set,this.#j=new Map,this.#K=0}#U;#j;#K;build(e,t,s){const i=new be({mutationCache:this,mutationId:++this.#K,options:e.defaultMutationOptions(t),state:s});return this.add(i),i}add(e){this.#U.add(e);const t=we(e);if("string"==typeof t){const s=this.#j.get(t);s?s.push(e):this.#j.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#U.delete(e)){const t=we(e);if("string"==typeof t){const s=this.#j.get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&this.#j.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=we(e);if("string"==typeof t){const s=this.#j.get(t),i=s?.find((e=>"pending"===e.state.status));return!i||i===e}return!0}runNext(e){const t=we(e);if("string"==typeof t){const s=this.#j.get(t)?.find((t=>t!==e&&t.state.isPaused));return s?.continue()??Promise.resolve()}return Promise.resolve()}clear(){L.batch((()=>{this.#U.forEach((e=>{this.notify({type:"removed",mutation:e})})),this.#U.clear(),this.#j.clear()}))}getAll(){return Array.from(this.#U)}find(e){const t={exact:!0,...e};return this.getAll().find((e=>_(t,e)))}findAll(e={}){return this.getAll().filter((t=>_(e,t)))}notify(e){L.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return L.batch((()=>Promise.all(e.map((e=>e.continue().catch(R))))))}};function we(e){return e.options.scope?.id}function Ce(e){return{onFetch:(t,s)=>{const i=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,n=t.state.data?.pages||[],a=t.state.data?.pageParams||[];let o={pages:[],pageParams:[]},u=0;const c=async()=>{let s=!1;const c=U(t.options,t.fetchOptions),l=async(e,i,r)=>{if(s)return Promise.reject();if(null==i&&e.pages.length)return Promise.resolve(e);const n={client:t.client,queryKey:t.queryKey,pageParam:i,direction:r?"backward":"forward",meta:t.options.meta};var a;a=n,Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(t.signal.aborted?s=!0:t.signal.addEventListener("abort",(()=>{s=!0})),t.signal)});const o=await c(n),{maxPages:u}=t.options,l=r?N:M;return{pages:l(e.pages,o,u),pageParams:l(e.pageParams,i,u)}};if(r&&n.length){const e="backward"===r,t={pages:n,pageParams:a},s=(e?Se:Oe)(i,t);o=await l(t,s,e)}else{const t=e??n.length;do{const e=0===u?a[0]??i.initialPageParam:Oe(i,o);if(u>0&&null==e)break;o=await l(o,e),u++}while(u<t)}return o};t.options.persister?t.fetchFn=()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=c}}}function Oe(e,{pages:t,pageParams:s}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function Se(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}const Ee=new class{#L;#k;#l;#H;#G;#B;#W;#X;constructor(e={}){this.#L=e.queryCache||new ve,this.#k=e.mutationCache||new Re,this.#l=e.defaultOptions||{},this.#H=new Map,this.#G=new Map,this.#B=0}mount(){this.#B++,1===this.#B&&(this.#W=j.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#L.onFocus())})),this.#X=H.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#L.onOnline())})))}unmount(){this.#B--,0===this.#B&&(this.#W?.(),this.#W=void 0,this.#X?.(),this.#X=void 0)}isFetching(e){return this.#L.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#k.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#L.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=this.#L.build(this,t),i=s.state.data;return void 0===i?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(O(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return this.#L.findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,s){const i=this.defaultQueryOptions({queryKey:e}),r=this.#L.get(i.queryHash),n=r?.state.data,a=function(e,t){return"function"==typeof e?e(t):e}(t,n);if(void 0!==a)return this.#L.build(this,i).setData(a,{...s,manual:!0})}setQueriesData(e,t,s){return L.batch((()=>this.#L.findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,s)]))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#L.get(t.queryHash)?.state}removeQueries(e){const t=this.#L;L.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const s=this.#L;return L.batch((()=>(s.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e,t={}){const s={revert:!0,...t},i=L.batch((()=>this.#L.findAll(e).map((e=>e.cancel(s)))));return Promise.all(i).then(R).catch(R)}invalidateQueries(e,t={}){return L.batch((()=>(this.#L.findAll(e).forEach((e=>{e.invalidate()})),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},i=L.batch((()=>this.#L.findAll(e).filter((e=>!e.isDisabled())).map((e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(R)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(i).then(R)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=this.#L.build(this,t);return s.isStaleByTime(O(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(R).catch(R)}fetchInfiniteQuery(e){return e.behavior=Ce(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(R).catch(R)}ensureInfiniteQueryData(e){return e.behavior=Ce(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return H.isOnline()?this.#k.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#L}getMutationCache(){return this.#k}getDefaultOptions(){return this.#l}setDefaultOptions(e){this.#l=e}setQueryDefaults(e,t){this.#H.set(T(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#H.values()],s={};return t.forEach((t=>{Q(e,t.queryKey)&&Object.assign(s,t.defaultOptions)})),s}setMutationDefaults(e,t){this.#G.set(T(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#G.values()],s={};return t.forEach((t=>{Q(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)})),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#l.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=q(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===k&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#l.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#L.clear(),this.#k.clear()}};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("modula-license-app");e&&(0,s.createRoot)(e).render(React.createElement(oe,{client:Ee},React.createElement(p,null,React.createElement(ge,null))))}))})();