!function(e){"use strict";e(document).ready((function(){e(".modula-no-drag #normal-sortables, .modula-no-drag #side-sortables").off(),e(".modula-feedback-notice .notice-dismiss").click((function(o){o.preventDefault();var t=e(this).parent();e.ajax({method:"POST",url:ajaxurl,data:{action:"modula-edit-notice"}}).done((function(e){t.remove()}))})),e(".copy-modula-shortcode").click((function(o){o.preventDefault();var t=e(this).parent().find("input");t.focus(),t.select(),document.execCommand("copy"),e(this).next("span").text("Shortcode copied"),e(".copy-modula-shortcode").not(e(this)).parent().find("span").text("")})),e("body").on("click","#modula-lightbox-upgrade .notice-dismiss",(function(o){o.preventDefault();var t=e(this).parent(),l={action:"modula_lbu_notice",nonce:modulaHelper._wpnonce};e.post(modulaHelper.ajax_url,l,(function(e){t.remove()}))}))}));const o=o=>{o.preventDefault();const l=o.data.upsell;e.get(modulaHelper.ajax_url,{action:"modula_modal-"+l+"_upgrade"},(o=>{e("body").addClass("modal-open"),e("body").append(o),e(document).one("click",".modula-modal__overlay."+l,{upsell:l},t),e(document).one("click",".modula-modal__dismiss."+l,{upsell:l},t)}))},t=o=>{const t=o.data.upsell;e(".modula-modal__overlay."+t).remove(),e("body").removeClass("modal-open")};e("body").on("click",'#adminmenu #menu-posts-modula-gallery ul li a[href="edit.php?post_type=modula-gallery&page=#modula-albums"]',{upsell:"albums"},o),e("body").on("click",'#adminmenu #menu-posts-modula-gallery ul li a[href="edit.php?post_type=modula-gallery&page=#gallery-defaults"]',{upsell:"gallery-defaults"},o),e("body").on("click",'#adminmenu #menu-posts-modula-gallery ul li a[href="edit.php?post_type=modula-gallery&page=#albums-defaults"]',{upsell:"albums-defaults"},o),e("body").on("click",'#adminmenu #menu-posts-modula-gallery ul li a[href="edit.php?post_type=modula-gallery&page=go-pro"]',(function(e){e.preventDefault(),window.open("https://wp-modula.com/pricing/?utm_source=modula-lite&utm_medium=admin-menu&utm_campaign=upsell","_blank")})),e("body").on("click",'#adminmenu #menu-posts-modula-gallery ul li a[href="edit.php?post_type=modula-gallery&page=#modula-licenses"]',{upsell:"image-licensing"},o),e("body").on("click","#modula-pro-bulk-editor-upsell .button",{upsell:"bulk-editor"},o),jQuery(window).on("load",(function(){let e=new URLSearchParams(window.location.search);e.has("page")&&"modula-lite-vs-pro"===e.get("page")&&e.has("extension")&&jQuery("html,body").animate({scrollTop:jQuery(".wpchill-plans-table.wpchill-highlight").offset().top-150},600)}));const l=()=>{const e=document.getElementById("side-sortables"),o=document.getElementById("submitdiv");if(!o||!e)return;const t=o.offsetTop+100,l="is-sticky";window.scrollY>=t?e.classList.add(l):e.classList.remove(l)};window.addEventListener("scroll",l),l()}(jQuery),function(e){var o={},t={};o.on=function(e,o){t[e]||(t[e]=[]),t[e].push(o)},o.off=function(e,o){t[e]&&(t[e]=t[e].filter((function(e){return e!==o})))},o.emit=function(e,o){t[e]&&t[e].forEach((function(e){e(o)}))},e.modulaEventBus=o}(this),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#publish");e&&e.addEventListener("click",(async o=>{const t=document.querySelector("#publishing-action .spinner"),l=document.querySelector("#post"),a=document.querySelector("#post_status"),n=document.querySelector("#hidden_post_status"),s=document.querySelector("#original_post_status"),d=document.querySelector("#post_ID");e.classList.add("disabled"),t.classList.add("is-active"),o.preventDefault();let u="publish";a.value!==n.value&&(u=a.value,n.value=a.value);const i=new FormData(l);i.append("post_status",u);try{if((await fetch("post.php",{method:"POST",body:i})).ok||(e.classList.remove("disabled"),t.classList.remove("is-active")),e.classList.remove("disabled"),t.classList.remove("is-active"),jQuery(window).off("beforeunload.edit-post"),void 0!==s&&"auto-draft"===s.value&&void 0!==d&&void 0!==d.value){const e=modulaHelper.admin_url+"post.php?action=edit&post="+d.value;history.replaceState(null,"",e),s.value=u}void 0!==wp.Modula.watermark&&void 0!==wp.Modula.watermark.Conditions&&wp.Modula.watermark.Conditions.removeSaveNotice()}catch(o){e.classList.remove("disabled"),t.classList.remove("is-active")}}))}));