!function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,(function(){function t(t,e){this.items=t,this.settings=e||{diacritics:!0}}t.prototype.tokenize=function(t){if(!(t=o(String(t||"").toLowerCase()))||!t.length)return[];var e,n,i,r,l=[],p=t.split(/ +/);for(e=0,n=p.length;e<n;e++){if(i=s(p[e]),this.settings.diacritics)for(r in a)a.hasOwnProperty(r)&&(i=i.replace(new RegExp(r,"g"),a[r]));l.push({string:p[e],regex:new RegExp(i,"i")})}return l},t.prototype.iterator=function(t,e){(r(t)?Array.prototype.forEach||function(t){for(var e=0,n=this.length;e<n;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)}).apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var n,o,s,r;function a(t,e){var n,i;return t?-1===(i=(t=String(t||"")).search(e.regex))?0:(n=e.string.length/t.length,0===i&&(n+=.5),n):0}t=this.prepareSearch(t,e),o=t.tokens,n=t.options.fields,s=o.length,r=t.options.nesting;var l,p=(l=n.length)?1===l?function(t,e){return a(i(e,n[0],r),t)}:function(t,e){for(var o=0,s=0;o<l;o++)s+=a(i(e,n[o],r),t);return s/l}:function(){return 0};return s?1===s?function(t){return p(o[0],t)}:"and"===t.options.conjunction?function(t){for(var e,n=0,i=0;n<s;n++){if((e=p(o[n],t))<=0)return 0;i+=e}return i/s}:function(t){for(var e=0,n=0;e<s;e++)n+=p(o[e],t);return n/s}:function(){return 0}},t.prototype.getSortFunction=function(t,n){var o,s,r,a,l,p,u,c,d,h,g;if(g=!(t=(r=this).prepareSearch(t,n)).query&&n.sort_empty||n.sort,d=function(t,e){return"$score"===t?e.score:i(r.items[e.id],t,n.nesting)},l=[],g)for(o=0,s=g.length;o<s;o++)!t.query&&"$score"===g[o].field||l.push(g[o]);if(t.query){for(h=!0,o=0,s=l.length;o<s;o++)if("$score"===l[o].field){h=!1;break}h&&l.unshift({field:"$score",direction:"desc"})}else for(o=0,s=l.length;o<s;o++)if("$score"===l[o].field){l.splice(o,1);break}for(c=[],o=0,s=l.length;o<s;o++)c.push("desc"===l[o].direction?-1:1);return(p=l.length)?1===p?(a=l[0].field,u=c[0],function(t,n){return u*e(d(a,t),d(a,n))}):function(t,n){var i,o,s;for(i=0;i<p;i++)if(s=l[i].field,o=c[i]*e(d(s,t),d(s,n)))return o;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var i=(e=n({},e)).fields,o=e.sort,s=e.sort_empty;return i&&!r(i)&&(e.fields=[i]),o&&!r(o)&&(e.sort=[o]),s&&!r(s)&&(e.sort_empty=[s]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var n,i,o,s,r=this;return i=this.prepareSearch(t,e),e=i.options,t=i.query,s=e.score||r.getScoreFunction(i),t.length?r.iterator(r.items,(function(t,o){n=s(t),(!1===e.filter||0<n)&&i.items.push({score:n,id:o})})):r.iterator(r.items,(function(t,e){i.items.push({score:1,id:e})})),(o=r.getSortFunction(i,e))&&i.items.sort(o),i.total=i.items.length,"number"==typeof e.limit&&(i.items=i.items.slice(0,e.limit)),i};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?e<t?1:t<e?-1:0:(t=l(String(t||"")),(e=l(String(e||"")))<t?1:t<e?-1:0)},n=function(t,e){var n,i,o,s;for(n=1,i=arguments.length;n<i;n++)if(s=arguments[n])for(o in s)s.hasOwnProperty(o)&&(t[o]=s[o]);return t},i=function(t,e,n){if(t&&e){if(!n)return t[e];for(var i=e.split(".");i.length&&(t=t[i.shift()]););return t}},o=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},s=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a={a:"[aá¸€á¸Ä‚ÄƒÃ‚Ã¢ÇÇŽÈºâ±¥È¦È§áº áº¡Ã„Ã¤Ã€Ã ÃÃ¡Ä€ÄÃƒÃ£Ã…Ã¥Ä…Ä„ÃƒÄ…Ä„]",b:"[bâ¢Î²Î’Bà¸¿ðŒá›’]",c:"[cÄ†Ä‡ÄˆÄ‰ÄŒÄÄŠÄ‹CÌ„cÌ„Ã‡Ã§á¸ˆá¸‰È»È¼Æ‡ÆˆÉ•á´„ï¼£ï½ƒ]",d:"[dÄŽÄá¸Šá¸‹á¸á¸‘á¸Œá¸á¸’á¸“á¸Žá¸ÄÄ‘DÌ¦dÌ¦Æ‰É–ÆŠÉ—Æ‹ÆŒáµ­á¶á¶‘È¡á´…ï¼¤ï½„Ã°]",e:"[eÃ‰Ã©ÃˆÃ¨ÃŠÃªá¸˜á¸™ÄšÄ›Ä”Ä•áº¼áº½á¸šá¸›áººáº»Ä–Ä—Ã‹Ã«Ä’Ä“È¨È©Ä˜Ä™á¶’É†É‡È„È…áº¾áº¿á»€á»á»„á»…á»‚á»ƒá¸œá¸á¸–á¸—á¸”á¸•È†È‡áº¸áº¹á»†á»‡â±¸á´‡ï¼¥ï½…É˜ÇÆÆÎµ]",f:"[fÆ‘Æ’á¸žá¸Ÿ]",g:"[gÉ¢â‚²Ç¤Ç¥ÄœÄÄžÄŸÄ¢Ä£Æ“É Ä Ä¡]",h:"[hÄ¤Ä¥Ä¦Ä§á¸¨á¸©áº–áº–á¸¤á¸¥á¸¢á¸£É¦Ê°Ç¶Æ•]",i:"[iÃÃ­ÃŒÃ¬Ä¬Ä­ÃŽÃ®ÇÇÃÃ¯á¸®á¸¯Ä¨Ä©Ä®Ä¯ÄªÄ«á»ˆá»‰ÈˆÈ‰ÈŠÈ‹á»Šá»‹á¸¬á¸­Æ—É¨É¨Ì†áµ»á¶–Ä°iIÄ±Éªï¼©ï½‰]",j:"[jÈ·Ä´ÄµÉˆÉ‰ÊÉŸÊ²]",k:"[kÆ˜Æ™ê€êá¸°á¸±Ç¨Ç©á¸²á¸³á¸´á¸µÎºÏ°â‚­]",l:"[lÅÅ‚Ä½Ä¾Ä»Ä¼Ä¹Äºá¸¶á¸·á¸¸á¸¹á¸¼á¸½á¸ºá¸»Ä¿Å€È½Æšâ± â±¡â±¢É«É¬á¶…É­È´ÊŸï¼¬ï½Œ]",n:"[nÅƒÅ„Ç¸Ç¹Å‡ÅˆÃ‘Ã±á¹„á¹…Å…Å†á¹†á¹‡á¹Šá¹‹á¹ˆá¹‰NÌˆnÌˆÆÉ²È Æžáµ°á¶‡É³ÈµÉ´ï¼®ï½ŽÅŠÅ‹]",o:"[oÃ˜Ã¸Ã–Ã¶Ã“Ã³Ã’Ã²Ã”Ã´Ç‘Ç’ÅÅ‘ÅŽÅÈ®È¯á»Œá»ÆŸÉµÆ Æ¡á»Žá»ÅŒÅÃ•ÃµÇªÇ«ÈŒÈÕ•Ö…]",p:"[pá¹”á¹•á¹–á¹—â±£áµ½Æ¤Æ¥áµ±]",q:"[qê–ê—Ê ÉŠÉ‹ê˜ê™qÌƒ]",r:"[rÅ”Å•ÉŒÉÅ˜Å™Å–Å—á¹˜á¹™ÈÈ‘È’È“á¹šá¹›â±¤É½]",s:"[sÅšÅ›á¹ á¹¡á¹¢á¹£êž¨êž©ÅœÅÅ Å¡ÅžÅŸÈ˜È™SÌˆsÌˆ]",t:"[tÅ¤Å¥á¹ªá¹«Å¢Å£á¹¬á¹­Æ®ÊˆÈšÈ›á¹°á¹±á¹®á¹¯Æ¬Æ­]",u:"[uÅ¬Å­É„Ê‰á»¤á»¥ÃœÃ¼ÃšÃºÃ™Ã¹Ã›Ã»Ç“Ç”Å°Å±Å¬Å­Æ¯Æ°á»¦á»§ÅªÅ«Å¨Å©Å²Å³È”È•âˆª]",v:"[vá¹¼á¹½á¹¾á¹¿Æ²Ê‹êžêŸâ±±Ê‹]",w:"[wáº‚áºƒáº€áºÅ´Åµáº„áº…áº†áº‡áºˆáº‰]",x:"[xáºŒáºáºŠáº‹Ï‡]",y:"[yÃÃ½á»²á»³Å¶Å·Å¸Ã¿á»¸á»¹áºŽáºá»´á»µÉŽÉÆ³Æ´]",z:"[zÅ¹Åºáºáº‘Å½Å¾Å»Å¼áº’áº“áº”áº•ÆµÆ¶]"},l=function(){var t,e,n,i,o="",s={};for(n in a)if(a.hasOwnProperty(n))for(o+=i=a[n].substring(2,a[n].length-1),t=0,e=i.length;t<e;t++)s[i.charAt(t)]=n;var r=new RegExp("["+o+"]","g");return function(t){return t.replace(r,(function(t){return s[t]})).toLowerCase()}}();return t})),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,(function(){var t={mixin:function(t){t.plugins={},t.prototype.initializePlugins=function(t){var n,i,o,s=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(n=0,i=t.length;n<i;n++)"string"==typeof t[n]?s.push(t[n]):(this.plugins.settings[t[n].name]=t[n].options,s.push(t[n].name));else if(t)for(o in t)t.hasOwnProperty(o)&&(this.plugins.settings[o]=t[o],s.push(o));for(;s.length;)this.require(s.shift())},t.prototype.loadPlugin=function(e){var n=this.plugins,i=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');n.requested[e]=!0,n.loaded[e]=i.fn.apply(this,[this.plugins.settings[e]||{}]),n.names.push(e)},t.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},t.define=function(e,n){t.plugins[e]={name:e,fn:n}}}},e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t})),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,(function(t,e,n){"use strict";function i(t,e){if("string"!=typeof e||e.length){var n="string"==typeof e?new RegExp(e,"i"):e,i=function(t){var e=0;if(3===t.nodeType){var o=t.data.search(n);if(0<=o&&0<t.data.length){var s=t.data.match(n),r=document.createElement("span");r.className="highlight";var a=t.splitText(o),l=(a.splitText(s[0].length),a.cloneNode(!0));r.appendChild(l),a.parentNode.replaceChild(r,a),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName)&&("highlight"!==t.className||"SPAN"!==t.tagName))for(var p=0;p<t.childNodes.length;++p)p+=i(t.childNodes[p]);return e};return t.each((function(){i(this)}))}}function o(){}function s(t){return void 0!==t}function r(t){return null==t?null:"boolean"==typeof t?t?"1":"0":t+""}function a(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function l(t,e,n){var i,o=t.trigger,s={};for(i in t.trigger=function(){var n=arguments[0];if(-1===e.indexOf(n))return o.apply(t,arguments);s[n]=arguments},n.apply(t,[]),t.trigger=o,s)s.hasOwnProperty(i)&&o.apply(t,s[i])}function p(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-t.value.length),e.start=n.text.length-i,e.length=i}return e}function u(e){function n(n,o){var s,r,a,l,u,c,d,h;o=o||{},(n=n||window.event||{}).metaKey||n.altKey||!o.force&&!1===e.data("grow")||(s=e.val(),n.type&&"keydown"===n.type.toLowerCase()&&(a=48<=(r=n.keyCode)&&r<=57||65<=r&&r<=90||96<=r&&r<=111||186<=r&&r<=222||32===r,46===r||8===r?(h=p(e[0])).length?s=s.substring(0,h.start)+s.substring(h.start+h.length):8===r&&h.start?s=s.substring(0,h.start-1)+s.substring(h.start+1):46===r&&void 0!==h.start&&(s=s.substring(0,h.start)+s.substring(h.start+1)):a&&(c=n.shiftKey,d=String.fromCharCode(n.keyCode),s+=d=c?d.toUpperCase():d.toLowerCase())),l=e.attr("placeholder"),!s&&l&&(s=l),(u=function(e,n){return e?(v.$testInput||(v.$testInput=t("<span />").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).appendTo("body")),v.$testInput.text(e),function(t,e,n){var i,o,s={};if(n)for(i=0,o=n.length;i<o;i++)s[n[i]]=t.css(n[i]);else s=t.css();e.css(s)}(n,v.$testInput,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),v.$testInput.width()):0}(s,e)+4)!==i&&(i=u,e.width(u),e.triggerHandler("resize")))}var i=null;e.on("keydown keyup update blur",n),n()}t.fn.removeHighlight=function(){return this.find("span.highlight").each((function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()})).end()},o.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},o.mixin=function(t){for(var e=["on","off","trigger"],n=0;n<e.length;n++)t.prototype[e[n]]=o.prototype[e[n]]};var c=/Mac/.test(navigator.userAgent),d=c?91:17,h=c?18:17,g=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,f=function(t,e,n){var i=t[e];t[e]=function(){var e=i.apply(t,arguments);return n.apply(t,arguments),e}},v=function(n,i){var o,s,r,a,l=this;(a=n[0]).selectize=l;var p=window.getComputedStyle&&window.getComputedStyle(a,null);if(r=(r=p?p.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction)||n.parents("[dir]:first").attr("dir")||"",t.extend(l,{order:0,settings:i,$input:n,tabIndex:n.attr("tabindex")||"",tagType:"select"===a.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++v.count,highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===i.loadThrottle?l.onSearchChange:function(t,e){var n;return function(){var i=this,o=arguments;window.clearTimeout(n),n=window.setTimeout((function(){t.apply(i,o)}),e)}}(l.onSearchChange,i.loadThrottle)}),l.sifter=new e(this.options,{diacritics:i.diacritics}),l.settings.options){for(o=0,s=l.settings.options.length;o<s;o++)l.registerOption(l.settings.options[o]);delete l.settings.options}if(l.settings.optgroups){for(o=0,s=l.settings.optgroups.length;o<s;o++)l.registerOptionGroup(l.settings.optgroups[o]);delete l.settings.optgroups}l.settings.mode=l.settings.mode||(1===l.settings.maxItems?"single":"multi"),"boolean"!=typeof l.settings.hideSelected&&(l.settings.hideSelected="multi"===l.settings.mode),l.initializePlugins(l.settings.plugins),l.setupCallbacks(),l.setupTemplates(),l.setup()};return o.mixin(v),void 0!==n?n.mixin(v):function(t,e){e=e||{},console.error("Selectize: Dependency MicroPlugin is missing"),e.explanation&&(console.group&&console.group(),console.error(e.explanation),console.group&&console.groupEnd())}(0,{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),t.extend(v.prototype,{setup:function(){var e,n,i,o,s,r,a,l,p,f,v=this,m=v.settings,y=v.eventNS,w=t(window),O=t(document),$=v.$input;if(a=v.settings.mode,l=$.attr("class")||"",e=t("<div>").addClass(m.wrapperClass).addClass(l).addClass(a),n=t("<div>").addClass(m.inputClass).addClass("items").appendTo(e),i=t('<input type="text" autocomplete="off" />').appendTo(n).attr("tabindex",$.is(":disabled")?"-1":v.tabIndex),r=t(m.dropdownParent||e),o=t("<div>").addClass(m.dropdownClass).addClass(a).hide().appendTo(r),s=t("<div>").addClass(m.dropdownContentClass).appendTo(o),(f=$.attr("id"))&&(i.attr("id",f+"-selectized"),t("label[for='"+f+"']").attr("for",f+"-selectized")),v.settings.copyClassesToDropdown&&o.addClass(l),e.css({width:$[0].style.width}),v.plugins.names.length&&(p="plugin-"+v.plugins.names.join(" plugin-"),e.addClass(p),o.addClass(p)),(null===m.maxItems||1<m.maxItems)&&1===v.tagType&&$.attr("multiple","multiple"),v.settings.placeholder&&i.attr("placeholder",m.placeholder),!v.settings.splitOn&&v.settings.delimiter){var C=v.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");v.settings.splitOn=new RegExp("\\s*"+C+"+\\s*")}$.attr("autocorrect")&&i.attr("autocorrect",$.attr("autocorrect")),$.attr("autocapitalize")&&i.attr("autocapitalize",$.attr("autocapitalize")),i[0].type=$[0].type,v.$wrapper=e,v.$control=n,v.$control_input=i,v.$dropdown=o,v.$dropdown_content=s,o.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",(function(t){t.stopImmediatePropagation()})),o.on("mouseenter","[data-selectable]",(function(){return v.onOptionHover.apply(v,arguments)})),o.on("mousedown click","[data-selectable]",(function(){return v.onOptionSelect.apply(v,arguments)})),function(t,e,n,i){t.on("mousedown","*:not(input)",(function(e){for(var n=e.target;n&&n.parentNode!==t[0];)n=n.parentNode;return e.currentTarget=n,i.apply(this,[e])}))}(n,0,0,(function(){return v.onItemSelect.apply(v,arguments)})),u(i),n.on({mousedown:function(){return v.onMouseDown.apply(v,arguments)},click:function(){return v.onClick.apply(v,arguments)}}),i.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return v.onKeyDown.apply(v,arguments)},keyup:function(){return v.onKeyUp.apply(v,arguments)},keypress:function(){return v.onKeyPress.apply(v,arguments)},resize:function(){v.positionDropdown.apply(v,[])},blur:function(){return v.onBlur.apply(v,arguments)},focus:function(){return v.ignoreBlur=!1,v.onFocus.apply(v,arguments)},paste:function(){return v.onPaste.apply(v,arguments)}}),O.on("keydown"+y,(function(t){v.isCmdDown=t[c?"metaKey":"ctrlKey"],v.isCtrlDown=t[c?"altKey":"ctrlKey"],v.isShiftDown=t.shiftKey})),O.on("keyup"+y,(function(t){t.keyCode===h&&(v.isCtrlDown=!1),16===t.keyCode&&(v.isShiftDown=!1),t.keyCode===d&&(v.isCmdDown=!1)})),O.on("mousedown"+y,(function(t){if(v.isFocused){if(t.target===v.$dropdown[0]||t.target.parentNode===v.$dropdown[0])return!1;v.$control.has(t.target).length||t.target===v.$control[0]||v.blur(t.target)}})),w.on(["scroll"+y,"resize"+y].join(" "),(function(){v.isOpen&&v.positionDropdown.apply(v,arguments)})),w.on("mousemove"+y,(function(){v.ignoreHover=!1})),this.revertSettings={$children:$.children().detach(),tabindex:$.attr("tabindex")},$.attr("tabindex",-1).hide().after(v.$wrapper),t.isArray(m.items)&&(v.setValue(m.items),delete m.items),g&&$.on("invalid"+y,(function(t){t.preventDefault(),v.isInvalid=!0,v.refreshState()})),v.updateOriginalInput(),v.refreshItems(),v.refreshState(),v.updatePlaceholder(),v.isSetup=!0,$.is(":disabled")&&v.disable(),v.on("change",this.onChange),$.data("selectize",v),$.addClass("selectized"),v.trigger("initialize"),!0===m.preload&&v.onSearchChange("")},setupTemplates:function(){var e=this.settings.labelField,n=this.settings.optgroupLabelField,i={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[n])+"</div>"},option:function(t,n){return'<div class="option">'+n(t[e])+"</div>"},item:function(t,n){return'<div class="item">'+n(t[e])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};this.settings.render=t.extend({},i,this.settings.render)},setupCallbacks:function(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)n.hasOwnProperty(t)&&(e=this.settings[n[t]])&&this.on(t,e)},onClick:function(t){this.isFocused&&this.isOpen||(this.focus(),t.preventDefault())},onMouseDown:function(e){var n=this,i=e.isDefaultPrevented();if(t(e.target),n.isFocused){if(e.target!==n.$control_input[0])return"single"===n.settings.mode?n.isOpen?n.close():n.open():i||n.setActiveItem(null),!1}else i||window.setTimeout((function(){n.focus()}),0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var n=this;n.isFull()||n.isInputHidden||n.isLocked?e.preventDefault():n.settings.splitOn&&setTimeout((function(){var e=n.$control_input.val();if(e.match(n.settings.splitOn))for(var i=t.trim(e).split(n.settings.splitOn),o=0,s=i.length;o<s;o++)n.createItem(i[o])}),0)},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){t.target,this.$control_input[0];var e=this;if(e.isLocked)9!==t.keyCode&&t.preventDefault();else{switch(t.keyCode){case 65:if(e.isCmdDown)return void e.selectAll();break;case 27:return void(e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close()));case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var n=e.getAdjacentOption(e.$activeOption,1);n.length&&e.setActiveOption(n,!0,!0)}return void t.preventDefault();case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,-1);i.length&&e.setActiveOption(i,!0,!0)}return void t.preventDefault();case 13:return void(e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault()));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),void(e.settings.create&&e.createItem()&&t.preventDefault());case 8:case 46:return void e.deleteSelection(t)}!e.isFull()&&!e.isInputHidden||(c?t.metaKey:t.ctrlKey)||t.preventDefault()}},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var n=e.$control_input.val()||"";e.lastValue!==n&&(e.lastValue=n,e.onSearchChange(n),e.refreshOptions(),e.trigger("type",n))},onSearchChange:function(t){var e=this,n=e.settings.load;n&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load((function(i){n.apply(e,[t,i])}))))},onFocus:function(t){var e=this,n=e.isFocused;if(e.isDisabled)return e.blur(),t&&t.preventDefault(),!1;e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.onSearchChange(""),n||e.trigger("focus"),e.$activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())},onBlur:function(t,e){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(t);var i=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),e&&e.focus&&e.focus(),n.isBlurring=!1,n.ignoreFocus=!1,n.trigger("blur")};n.isBlurring=!0,n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,i):i()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(e){var n,i,o=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),(i=t(e.currentTarget)).hasClass("create")?o.createItem(null,(function(){o.settings.closeAfterSelect&&o.close()})):void 0!==(n=i.attr("data-value"))&&(o.lastQuery=null,o.setTextboxValue(""),o.addItem(n),o.settings.closeAfterSelect?o.close():!o.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&o.setActiveOption(o.getOption(n)))},onItemSelect:function(t){this.isLocked||"multi"===this.settings.mode&&(t.preventDefault(),this.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,n=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||n.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){l(this,e?[]:["change"],(function(){this.clear(e),this.addItems(t,e)}))},setActiveItem:function(e,n){var i,o,s,r,a,l,p,u,c=this;if("single"!==c.settings.mode){if(!(e=t(e)).length)return t(c.$activeItems).removeClass("active"),c.$activeItems=[],void(c.isFocused&&c.showInput());if("mousedown"===(i=n&&n.type.toLowerCase())&&c.isShiftDown&&c.$activeItems.length){for(u=c.$control.children(".active:last"),r=Array.prototype.indexOf.apply(c.$control[0].childNodes,[u[0]]),(a=Array.prototype.indexOf.apply(c.$control[0].childNodes,[e[0]]))<r&&(p=r,r=a,a=p),o=r;o<=a;o++)l=c.$control[0].childNodes[o],-1===c.$activeItems.indexOf(l)&&(t(l).addClass("active"),c.$activeItems.push(l));n.preventDefault()}else"mousedown"===i&&c.isCtrlDown||"keydown"===i&&this.isShiftDown?e.hasClass("active")?(s=c.$activeItems.indexOf(e[0]),c.$activeItems.splice(s,1),e.removeClass("active")):c.$activeItems.push(e.addClass("active")[0]):(t(c.$activeItems).removeClass("active"),c.$activeItems=[e.addClass("active")[0]]);c.hideInput(),this.isFocused||c.focus()}},setActiveOption:function(e,n,i){var o,r,a,l,p,u=this;u.$activeOption&&u.$activeOption.removeClass("active"),u.$activeOption=null,(e=t(e)).length&&(u.$activeOption=e.addClass("active"),!n&&s(n)||(o=u.$dropdown_content.height(),r=u.$activeOption.outerHeight(!0),n=u.$dropdown_content.scrollTop()||0,p=(l=a=u.$activeOption.offset().top-u.$dropdown_content.offset().top+n)-o+r,o+n<a+r?u.$dropdown_content.stop().animate({scrollTop:p},i?u.settings.scrollDuration:0):a<n&&u.$dropdown_content.stop().animate({scrollTop:l},i?u.settings.scrollDuration:0)))},selectAll:function(){var t=this;"single"!==t.settings.mode&&(t.$activeItems=Array.prototype.slice.apply(t.$control.children(":not(input)").addClass("active")),t.$activeItems.length&&(t.hideInput(),t.close()),t.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout((function(){t.ignoreFocus=!1,t.onFocus()}),0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}},search:function(e){var n,i,o,s=this,a=s.settings,l=this.getSearchOptions();if(a.score&&"function"!=typeof(o=s.settings.score.apply(this,[e])))throw new Error('Selectize "score" setting must be a function that returns a function');if(e!==s.lastQuery?(s.lastQuery=e,i=s.sifter.search(e,t.extend(l,{score:o})),s.currentResults=i):i=t.extend(!0,{},s.currentResults),a.hideSelected)for(n=i.items.length-1;0<=n;n--)-1!==s.items.indexOf(r(i.items[n].id))&&i.items.splice(n,1);return i},refreshOptions:function(e){var n,o,s,a,l,p,u,c,d,h,g,f,v,m,y,w;void 0===e&&(e=!0);var O,$,C=this,b=t.trim(C.$control_input.val()),x=C.search(b),S=C.$dropdown_content,I=C.$activeOption&&r(C.$activeOption.attr("data-value"));for(a=x.items.length,"number"==typeof C.settings.maxOptions&&(a=Math.min(a,C.settings.maxOptions)),l={},p=[],n=0;n<a;n++)for(u=C.options[x.items[n].id],c=C.render("option",u),d=u[C.settings.optgroupField]||"",o=0,s=(h=t.isArray(d)?d:[d])&&h.length;o<s;o++)d=h[o],C.optgroups.hasOwnProperty(d)||(d=""),l.hasOwnProperty(d)||(l[d]=document.createDocumentFragment(),p.push(d)),l[d].appendChild(c);for(this.settings.lockOptgroupOrder&&p.sort((function(t,e){return(C.optgroups[t].$order||0)-(C.optgroups[e].$order||0)})),g=document.createDocumentFragment(),n=0,a=p.length;n<a;n++)d=p[n],C.optgroups.hasOwnProperty(d)&&l[d].childNodes.length?((f=document.createDocumentFragment()).appendChild(C.render("optgroup_header",C.optgroups[d])),f.appendChild(l[d]),g.appendChild(C.render("optgroup",t.extend({},C.optgroups[d],{html:(O=f,$=void 0,$=document.createElement("div"),$.appendChild(O.cloneNode(!0)),$.innerHTML),dom:f})))):g.appendChild(l[d]);if(S.html(g),C.settings.highlight&&(S.removeHighlight(),x.query.length&&x.tokens.length))for(n=0,a=x.tokens.length;n<a;n++)i(S,x.tokens[n].regex);if(!C.settings.hideSelected)for(n=0,a=C.items.length;n<a;n++)C.getOption(C.items[n]).addClass("selected");(v=C.canCreate(b))&&(S.prepend(C.render("option_create",{input:b})),w=t(S[0].childNodes[0])),C.hasOptions=0<x.items.length||v,C.hasOptions?(0<x.items.length?((y=I&&C.getOption(I))&&y.length?m=y:"single"===C.settings.mode&&C.items.length&&(m=C.getOption(C.items[0])),m&&m.length||(m=w&&!C.settings.addPrecedence?C.getAdjacentOption(w,1):S.find("[data-selectable]:first"))):m=w,C.setActiveOption(m),e&&!C.isOpen&&C.open()):(C.setActiveOption(null),e&&C.isOpen&&C.close())},addOption:function(e){var n,i,o,s=this;if(t.isArray(e))for(n=0,i=e.length;n<i;n++)s.addOption(e[n]);else(o=s.registerOption(e))&&(s.userOptions[o]=!0,s.lastQuery=null,s.trigger("option_add",o,e))},registerOption:function(t){var e=r(t[this.settings.valueField]);return null!=e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=r(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,n){var i,o,s,a,l,p,u,c=this;if(e=r(e),s=r(n[c.settings.valueField]),null!==e&&c.options.hasOwnProperty(e)){if("string"!=typeof s)throw new Error("Value must be set in option data");u=c.options[e].$order,s!==e&&(delete c.options[e],-1!==(a=c.items.indexOf(e))&&c.items.splice(a,1,s)),n.$order=n.$order||u,c.options[s]=n,l=c.renderCache.item,p=c.renderCache.option,l&&(delete l[e],delete l[s]),p&&(delete p[e],delete p[s]),-1!==c.items.indexOf(s)&&(i=c.getItem(e),o=t(c.render("item",n)),i.hasClass("active")&&o.addClass("active"),i.replaceWith(o)),c.lastQuery=null,c.isOpen&&c.refreshOptions(!1)}},removeOption:function(t,e){var n=this;t=r(t);var i=n.renderCache.item,o=n.renderCache.option;i&&delete i[t],o&&delete o[t],delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={};var n=e.options;t.each(e.options,(function(t,i){-1==e.items.indexOf(t)&&delete n[t]})),e.options=e.sifter.items=n,e.lastQuery=null,e.trigger("option_clear")},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,n){var i=this.$dropdown.find("[data-selectable]"),o=i.index(e)+n;return 0<=o&&o<i.length?i.eq(o):t()},getElementWithValue:function(e,n){if(null!=(e=r(e)))for(var i=0,o=n.length;i<o;i++)if(n[i].getAttribute("data-value")===e)return t(n[i]);return t()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(e,n){this.buffer=document.createDocumentFragment();for(var i=this.$control[0].childNodes,o=0;o<i.length;o++)this.buffer.appendChild(i[o]);for(var s=t.isArray(e)?e:[e],r=(o=0,s.length);o<r;o++)this.isPending=o<r-1,this.addItem(s[o],n);var a=this.$control[0];a.insertBefore(this.buffer,a.firstChild),this.buffer=null},addItem:function(e,n){l(this,n?[]:["change"],(function(){var i,o,s,a,l,p=this,u=p.settings.mode;e=r(e),-1===p.items.indexOf(e)?p.options.hasOwnProperty(e)&&("single"===u&&p.clear(n),"multi"===u&&p.isFull()||(i=t(p.render("item",p.options[e])),l=p.isFull(),p.items.splice(p.caretPos,0,e),p.insertAtCaret(i),p.isPending&&(l||!p.isFull())||p.refreshState(),p.isSetup&&(s=p.$dropdown_content.find("[data-selectable]"),p.isPending||(o=p.getOption(e),a=p.getAdjacentOption(o,1).attr("data-value"),p.refreshOptions(p.isFocused&&"single"!==u),a&&p.setActiveOption(p.getOption(a))),!s.length||p.isFull()?p.close():p.isPending||p.positionDropdown(),p.updatePlaceholder(),p.trigger("item_add",e,i),p.isPending||p.updateOriginalInput({silent:n})))):"single"===u&&p.close()}))},removeItem:function(e,n){var i,o,s,a=this;e=r((i=e instanceof t?e:a.getItem(e)).attr("data-value")),-1!==(o=a.items.indexOf(e))&&(i.remove(),i.hasClass("active")&&(s=a.$activeItems.indexOf(i[0]),a.$activeItems.splice(s,1)),a.items.splice(o,1),a.lastQuery=null,!a.settings.persist&&a.userOptions.hasOwnProperty(e)&&a.removeOption(e,n),o<a.caretPos&&a.setCaret(a.caretPos-1),a.refreshState(),a.updatePlaceholder(),a.updateOriginalInput({silent:n}),a.positionDropdown(),a.trigger("item_remove",e,i))},createItem:function(e,n){var i=this,o=i.caretPos;e=e||t.trim(i.$control_input.val()||"");var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof n&&(n=!0),!i.canCreate(e))return s(),!1;i.lock();var a="function"==typeof i.settings.create?this.settings.create:function(t){var e={};return e[i.settings.labelField]=t,e[i.settings.valueField]=t,e},l=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}((function(t){if(i.unlock(),!t||"object"!=typeof t)return s();var e=r(t[i.settings.valueField]);if("string"!=typeof e)return s();i.setTextboxValue(""),i.addOption(t),i.setCaret(o),i.addItem(e),i.refreshOptions(n&&"single"!==i.settings.mode),s(t)})),p=a.apply(this,[e,l]);return void 0!==p&&l(p),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var e=this,n=e.isFull(),i=e.isLocked;e.$wrapper.toggleClass("rtl",e.rtl),e.$control.toggleClass("focus",e.isFocused).toggleClass("disabled",e.isDisabled).toggleClass("required",e.isRequired).toggleClass("invalid",e.isInvalid).toggleClass("locked",i).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",e.isFocused&&!e.isInputHidden).toggleClass("dropdown-active",e.isOpen).toggleClass("has-options",!t.isEmptyObject(e.options)).toggleClass("has-items",0<e.items.length),e.$control_input.data("grow",!n&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,n,i,o,s=this;if(t=t||{},1===s.tagType){for(i=[],e=0,n=s.items.length;e<n;e++)o=s.options[s.items[e]][s.settings.labelField]||"",i.push('<option value="'+a(s.items[e])+'" selected="selected">'+a(o)+"</option>");i.length||this.$input.attr("multiple")||i.push('<option value="" selected="selected"></option>'),s.$input.html(i.join(""))}else s.$input.val(s.getValue()),s.$input.attr("value",s.$input.val());s.isSetup&&(t.silent||s.trigger("change",s.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),t.$dropdown.css({visibility:"hidden",display:"block"}),t.positionDropdown(),t.$dropdown.css({visibility:"visible"}),t.trigger("dropdown_open",t.$dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&(t.hideInput(),t.isBlurring||t.$control_input.blur()),t.isOpen=!1,t.$dropdown.hide(),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t[0].getBoundingClientRect().width,top:e.top,left:e.left})},clear:function(t){var e=this;e.items.length&&(e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput({silent:t}),e.refreshState(),e.showInput(),e.trigger("clear"))},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length),n=t[0],i=this.buffer||this.$control[0];0===e?i.insertBefore(n,i.firstChild):i.insertBefore(n,i.childNodes[e]),this.setCaret(e+1)},deleteSelection:function(e){var n,i,o,s,r,a,l,u,c,d=this;if(o=e&&8===e.keyCode?-1:1,s=p(d.$control_input[0]),d.$activeOption&&!d.settings.hideSelected&&(l=d.getAdjacentOption(d.$activeOption,-1).attr("data-value")),r=[],d.$activeItems.length){for(c=d.$control.children(".active:"+(0<o?"last":"first")),a=d.$control.children(":not(input)").index(c),0<o&&a++,n=0,i=d.$activeItems.length;n<i;n++)r.push(t(d.$activeItems[n]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(d.isFocused||"single"===d.settings.mode)&&d.items.length&&(o<0&&0===s.start&&0===s.length?r.push(d.items[d.caretPos-1]):0<o&&s.start===d.$control_input.val().length&&r.push(d.items[d.caretPos]));if(!r.length||"function"==typeof d.settings.onDelete&&!1===d.settings.onDelete.apply(d,[r]))return!1;for(void 0!==a&&d.setCaret(a);r.length;)d.removeItem(r.pop());return d.showInput(),d.positionDropdown(),d.refreshOptions(!0),l&&(u=d.getOption(l)).length&&d.setActiveOption(u),!0},advanceSelection:function(t,e){var n,i,o,s,r,a=this;0!==t&&(a.rtl&&(t*=-1),n=0<t?"last":"first",i=p(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(s=a.$control_input.val().length,(t<0?0!==i.start||0!==i.length:i.start!==s)||s||a.advanceCaret(t,e)):(r=a.$control.children(".active:"+n)).length&&(o=a.$control.children(":not(input)").index(r),a.setActiveItem(null),a.setCaret(0<t?o+1:o)))},advanceCaret:function(t,e){var n,i,o=this;0!==t&&(n=0<t?"next":"prev",o.isShiftDown?(i=o.$control_input[n]()).length&&(o.hideInput(),o.setActiveItem(i),e&&e.preventDefault()):o.setCaret(o.caretPos+t))},setCaret:function(e){var n,i,o,s,r=this;if(e="single"===r.settings.mode?r.items.length:Math.max(0,Math.min(r.items.length,e)),!r.isPending)for(n=0,i=(o=r.$control.children(":not(input)")).length;n<i;n++)s=t(o[n]).detach(),n<e?r.$control_input.before(s):r.$control.append(s);r.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){var t=this;t.$input.prop("disabled",!1),t.$control_input.prop("disabled",!1).prop("tabindex",t.tabIndex),t.isDisabled=!1,t.unlock()},destroy:function(){var e=this,n=e.eventNS,i=e.revertSettings;e.trigger("destroy"),e.off(),e.$wrapper.remove(),e.$dropdown.remove(),e.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),e.$control_input.removeData("grow"),e.$input.removeData("selectize"),0==--v.count&&v.$testInput&&(v.$testInput.remove(),v.$testInput=void 0),t(window).off(n),t(document).off(n),t(document.body).off(n),delete e.$input[0].selectize},render:function(e,n){var i,o,l="",p=!1,u=this;return"option"!==e&&"item"!==e||(p=!!(i=r(n[u.settings.valueField]))),p&&(s(u.renderCache[e])||(u.renderCache[e]={}),u.renderCache[e].hasOwnProperty(i))?u.renderCache[e][i]:(l=t(u.settings.render[e].apply(this,[n,a])),"option"===e||"option_create"===e?n[u.settings.disabledField]||l.attr("data-selectable",""):"optgroup"===e&&(o=n[u.settings.optgroupValueField]||"",l.attr("data-group",o),n[u.settings.disabledField]&&l.attr("data-disabled","")),"option"!==e&&"item"!==e||l.attr("data-value",i||""),p&&(u.renderCache[e][i]=l[0]),l[0])},clearCache:function(t){void 0===t?this.renderCache={}:delete this.renderCache[t]},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&("string"!=typeof e||new RegExp(e).test(t))&&(!(e instanceof RegExp)||e.test(t))}}),v.count=0,v.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(e){var n=t.fn.selectize.defaults,i=t.extend({},n,e),o=i.dataAttr,s=i.labelField,a=i.valueField,l=i.disabledField,p=i.optgroupField,u=i.optgroupLabelField,c=i.optgroupValueField;return this.each((function(){if(!this.selectize){var d=t(this),h=this.tagName.toLowerCase(),g=d.attr("placeholder")||d.attr("data-placeholder");g||i.allowEmptyOption||(g=d.children('option[value=""]').text());var f={placeholder:g,options:[],optgroups:[],items:[]};"select"===h?function(e,n){function d(t){var e=o&&t.attr(o);return"string"==typeof e&&e.length?JSON.parse(e):null}function h(e,o){var u=r((e=t(e)).val());if(u||i.allowEmptyOption)if(O.hasOwnProperty(u)){if(o){var c=O[u][p];c?t.isArray(c)?c.push(o):O[u][p]=[c,o]:O[u][p]=o}}else{var h=d(e)||{};h[s]=h[s]||e.text(),h[a]=h[a]||u,h[l]=h[l]||e.prop("disabled"),h[p]=h[p]||o,O[u]=h,w.push(h),e.is(":selected")&&n.items.push(u)}}function g(e){var i,o,s,r,a;for((s=(e=t(e)).attr("label"))&&((r=d(e)||{})[u]=s,r[c]=s,r[l]=e.prop("disabled"),n.optgroups.push(r)),i=0,o=(a=t("option",e)).length;i<o;i++)h(a[i],s)}var f,v,m,y,w=n.options,O={};for(n.maxItems=e.attr("multiple")?null:1,f=0,v=(y=e.children()).length;f<v;f++)"optgroup"===(m=y[f].tagName.toLowerCase())?g(y[f]):"option"===m&&h(y[f])}(d,f):function(e,n){var r,l,p,u,c=e.attr(o);if(c)for(n.options=JSON.parse(c),r=0,l=n.options.length;r<l;r++)n.items.push(n.options[r][a]);else{var d=t.trim(e.val()||"");if(!i.allowEmptyOption&&!d.length)return;for(r=0,l=(p=d.split(i.delimiter)).length;r<l;r++)(u={})[s]=p[r],u[a]=p[r],n.options.push(u);n.items=p}}(d,f),new v(d,t.extend(!0,{},n,f,e))}}))},t.fn.selectize.defaults=v.defaults,t.fn.selectize.support={validity:g},v.define("drag_drop",(function(e){if(!t.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var n,i,o,s=this;s.lock=(n=s.lock,function(){var t=s.$control.data("sortable");return t&&t.disable(),n.apply(s,arguments)}),s.unlock=(i=s.unlock,function(){var t=s.$control.data("sortable");return t&&t.enable(),i.apply(s,arguments)}),s.setup=(o=s.setup,function(){o.apply(this,arguments);var e=s.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:s.isLocked,start:function(t,n){n.placeholder.css("width",n.helper.css("width")),e.css({overflow:"visible"})},stop:function(){e.css({overflow:"hidden"});var n=s.$activeItems?s.$activeItems.slice():null,i=[];e.children("[data-value]").each((function(){i.push(t(this).attr("data-value"))})),s.setValue(i),s.setActiveItem(n)}})})}})),v.define("dropdown_header",(function(e){var n,i=this;e=t.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),i.setup=(n=i.setup,function(){n.apply(i,arguments),i.$dropdown_header=t(e.html(e)),i.$dropdown.prepend(i.$dropdown_header)})})),v.define("optgroup_columns",(function(e){var n,i=this;function o(){var n,o,r,a,l,p,u;if((o=(u=t("[data-group]",i.$dropdown_content)).length)&&i.$dropdown_content.width()){if(e.equalizeHeight){for(n=r=0;n<o;n++)r=Math.max(r,u.eq(n).height());u.css({height:r})}e.equalizeWidth&&(p=i.$dropdown_content.innerWidth()-s(),a=Math.round(p/o),u.css({width:a}),1<o&&(l=p-a*(o-1),u.eq(o-1).css({width:l})))}}e=t.extend({equalizeWidth:!0,equalizeHeight:!0},e),this.getAdjacentOption=function(e,n){var i=e.closest("[data-group]").find("[data-selectable]"),o=i.index(e)+n;return 0<=o&&o<i.length?i.eq(o):t()},this.onKeyDown=(n=i.onKeyDown,function(t){var e,o,s,r;return!this.isOpen||37!==t.keyCode&&39!==t.keyCode?n.apply(this,arguments):(i.ignoreHover=!0,e=(r=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((o=(s=(r=37===t.keyCode?r.prev("[data-group]"):r.next("[data-group]")).find("[data-selectable]")).eq(Math.min(s.length-1,e))).length&&this.setActiveOption(o)))});var s=function(){var t,e=s.width,n=document;return void 0===e&&((t=n.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,n.body.appendChild(t),e=s.width=t.offsetWidth-t.clientWidth,n.body.removeChild(t)),e};(e.equalizeHeight||e.equalizeWidth)&&(f(this,"positionDropdown",o),f(this,"refreshOptions",o))})),v.define("remove_button",(function(e){var n,i,o,s,r;e=t.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e),"single"!==this.settings.mode?(s=n=this,r='<a href="javascript:void(0)" class="'+(i=e).className+'" tabindex="-1" title="'+a(i.title)+'">'+i.label+"</a>",n.setup=(o=s.setup,function(){if(i.append){var e=s.settings.render.item;s.settings.render.item=function(t){return function(t,e){var n=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,n)+e+t.substring(n)}(e.apply(n,arguments),r)}}o.apply(n,arguments),n.$control.on("click","."+i.className,(function(e){if(e.preventDefault(),!s.isLocked){var n=t(e.currentTarget).parent();s.setActiveItem(n),s.deleteSelection()&&s.setCaret(s.items.length)}}))})):function(e,n){n.className="remove-single";var i,o=e,s='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+a(n.title)+'">'+n.label+"</a>";e.setup=(i=o.setup,function(){if(n.append){var r=t(o.$input.context).attr("id"),a=(t("#"+r),o.settings.render.item);o.settings.render.item=function(n){return function(e,n){return t("<span>").append(e).append(n)}(a.apply(e,arguments),s)}}i.apply(e,arguments),e.$control.on("click","."+n.className,(function(t){t.preventDefault(),o.isLocked||o.clear()}))})}(this,e)})),v.define("restore_on_backspace",(function(t){var e;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=(e=this.onKeyDown,function(n){var i,o;return 8===n.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&0<=(i=this.caretPos-1)&&i<this.items.length?(o=this.options[this.items[i]],this.deleteSelection(n)&&(this.setTextboxValue(t.text.apply(this,[o])),this.refreshOptions(!0)),void n.preventDefault()):e.apply(this,arguments)})})),v}));